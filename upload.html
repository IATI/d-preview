<html>
  <head>
	<title>D-Preview Logs</title>
	<style>
	</style>
	<script
		src="https://code.jquery.com/jquery-3.2.1.min.js"
		integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
		crossorigin="anonymous"></script>
	 <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.bundle.min.js"></script>
	<script>

	
let addchart=function(data,opts){
 
	let div=$('<div> <canvas></canvas> </div>')
	$( opts.body || "body" ).append(div)
	let ctx=div.children(":first")[0].getContext("2d");

	let dl=[]
	let dv=[]
	let idx=0
	for(let n in data){
		dl[idx]=(new Date(Number(n)*8.64e7)).toLocaleDateString()
		dv[idx]=data[n]
		idx++
	}
	
let config = {
	type: 'line',
	data: {
		labels: dl,
		datasets: [{
			label: opts.name || "Filled",
			backgroundColor: opts.color || "#f44",
			borderColor: opts.color || "#f44",
			data: dv,
			fill: true,
		}]
	},
	options: {
		responsive: true,
		title:{
			display:opts.title && true || false,
			text:opts.title || 'Chart.js Line Chart',
			fontSize:14
		},
		tooltips: {
			mode: 'index',
			intersect: false,
		},
		hover: {
			mode: 'nearest',
			intersect: true
		},
		scales: {
			xAxes: [{
				display: true,
				scaleLabel: {
					display: true,
					labelString: 'Day'
				}
			}],
			yAxes: [{
				display: true,
				scaleLabel: {
					display: true,
					labelString: 'Amount'
				}
			}]
		}
	}
};

   return new Chart(ctx, config);
};

		$.getJSON("upload.json", function(st) {


			let divs=$(`<div class="all_divs"/>`)
			$(".wrap").append(divs)

			{
				let n="visits"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
			{
				let n="ips"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
			{
				let n="uploads"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
			{
				let n="uploads_by_url"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
			{
				let n="uploads_ignored"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
			{
				let n="uploads_max_size"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
			{
				let n="uploads_total_size"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
			{
				let n="uploads_ignored_total_size"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
			{
				let n="errors"
				let div=divs.append("<div />")
				div.append("<span>"+n+"</span>")

				addchart( st[n] , {
					body:div,
				})
			}
		})
	</script>
 </head>
  <body>
  <h1>D-Preview Logs</h1>
  <div class="wrap"></div>
  </body>
</html>
